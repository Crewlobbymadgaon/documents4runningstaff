<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Digital Library for Running Staff</title>
    <link rel="manifest" href="/documents4runningstaff/manifest.json" />
    <link rel="icon" href="/documents4runningstaff/favicon.ico" />
    <link rel="apple-touch-icon" href="/documents4runningstaff/icon-192.png" />
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600&display=swap" rel="stylesheet" />
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600&display=swap" as="style" />
    
    <meta name="theme-color" content="#1f2937" />
    <script src="https://cdn.tailwindcss.com"></script>
    

    <style>
      .font-rajdhani {
        font-family: 'Rajdhani', sans-serif;
      }
      
      :root {
  --footer-height: 48px;
}
      
  #menu-items, #main-content {
    transition: opacity 0.3s ease;
  }

  .fade-hidden {
  opacity: 0;
  pointer-events: none;
}

</style>
    
  </head>

  <body class="bg-gray-50 text-gray-800">
  <main class="pb-[var(--footer-height)]">
    <div class="sticky top-0 z-50">

    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-900 via-blue-700 to-blue-900 text-white py-3 shadow-md">
  <div class="text-center px-4">
    <h1 class="font-rajdhani text-4xl sm:text-5xl md:text-6xl leading-tight font-extrabold">
      Digital Library<br class="sm:hidden" />
      <span class="text-yellow-300">for</span><br class="sm:hidden" />
      Running Staff
    </h1>
    <div class="mt-1 text-base sm:text-xl italic text-yellow-200 transition-opacity duration-700 ease-in opacity-100">
      <span id="slogan"></span>
    </div>
  </div>
</header>
     
    


<!-- Header with Menu and Home Icons -->
<div class="bg-gradient-to-r from-blue-900 via-blue-700 to-blue-900 px-4 sm:px-6 md:px-8">
  <div class="max-w-7xl mx-auto text-center">
    <div class="flex justify-center gap-3 py-2 sm:py-3">
<div class="inline-flex items-center gap-2 
                text-xs sm:text-sm font-bold text-white 
                bg-gradient-to-b from-blue-900 via-blue-500 to-blue-900 
                hover:scale-105 transform transition duration-200 
                px-3 py-1.5 sm:px-4 sm:py-2 
                rounded-md border border-blue-950 shadow-lg">
  

        <!-- Menu Icon Button -->
        <button id="menu-button" class="transition hover:scale-105 focus:outline-none">
          <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24" class="w-4 h-4 sm:w-5 sm:h-5">
              <path d="M4 6h16M4 12h16M4 18h16" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <span>Menu</span>
          </div>
        </button>

        <!-- Home Icon Button (initially hidden) -->
        <button id="home-button" class="transition hover:scale-105 focus:outline-none hidden">
          <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24" class="w-4 h-4 sm:w-5 sm:h-5">
              <path d="M3 9.75L12 3l9 6.75v9.75A1.5 1.5 0 0 1 19.5 21h-3.75V13.5h-7.5V21H4.5A1.5 1.5 0 0 1 3 19.5V9.75Z" />
            </svg>
            <span>Home</span>
          </div>
        </button>

      </div>
    </div>
  </div>
</div>
    

 
    
<div id="latest-banner" class="bg-white text-center py-2 border-b border-gray-300">
  <span class="font-bold text-red-700 text-base sm:text-xl animate-pulse">
    ðŸš¨ Latest Circulars for Running Staff
  </span>
</div>
    </div>

      <!-- Main Content Wrapper -->
<div id="main-content">
 <!-- Main Content -->
<div class="p-4 space-y-6 max-w-3xl mx-auto">    
    

<!-- LATEST DOCUMENTS -->
<div class="p-4 space-y-6 max-w-3xl mx-auto mt-4">

  <div id="latest-shed"></div>

  <div id="latest-safety"></div>
  <div id="latest-counselling"></div>
  <div id="latest-gsr"></div>
  <div id="latest-wtt"></div>
  <div id="latest-accident"></div>

</div>
</div>
</div>
    
    

    
    
<div id="menu-items"
     class="hidden mt-4
        
            grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3
            gap-y-3 gap-x-4 px-4
            max-w-screen-xl mx-auto">



<!-- Shed Order -->
<a href="so_lobby_selector.html"
   class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-red-900 via-red-500 to-red-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center"
          style="text-shadow: 1px 1px 2px black;">
      Shed Order
    </span>
  </div>
</a>

  <!-- Safety Circular -->
  <a href="safetycircular.html"
     class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-orange-900 via-orange-500 to-orange-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center" style="text-shadow: 1px 1px 2px black;">Safety Circular</span>
</div>
</a>

  <!-- Counselling Subjects -->
  <!-- Counselling Subjects -->
<a href="counselling.html"
   class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8]
          flex items-center bg-gradient-to-b from-yellow-900 via-yellow-500 to-yellow-900
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg
          transition duration-200 ease-in-out">
  
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner
              flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png"
         alt="Counselling Icon"
         class="w-full h-full object-contain" />
  </div>

  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center"
          style="text-shadow: 1px 1px 2px black;">
      Counselling Topic
    </span>
  </div>
</a>



  <!-- Other Circulars -->
  <a href="other_circulars.html"
     class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-green-900 via-green-500 to-green-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center" style="text-shadow: 1px 1px 2px black;">Other Circulars</span>
</div>
</a>

  <!-- G&SR -->
  <a href="gsr.html"
     class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-purple-900 via-purple-500 to-purple-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center" style="text-shadow: 1px 1px 2px black;">G&amp;SR</span>
</div>
</a>

  <!-- Accident Manual -->
  <a href="accident_manual.html"
     class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-blue-900 via-blue-500 to-blue-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center" style="text-shadow: 1px 1px 2px black;">Accident Manual</span>
</div>
</a>

  <!-- WTT -->
  <a href="wtt.html"
     class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-pink-900 via-pink-500 to-pink-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center" style="text-shadow: 1px 1px 2px black;">WTT</span>
</div>
</a>

  <!-- Reading Materials -->
  <a href="reading_materials.html"
     class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-teal-900 via-teal-500 to-teal-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center" style="text-shadow: 1px 1px 2px black;">Reading Materials</span>
</div>
</a>

  <!-- TSD -->
  <a href="tsd.html"
     class="relative w-full aspect-[6/1.2] sm:aspect-[6/1.8] 
          flex items-center bg-gradient-to-b from-cyan-900 via-cyan-500 to-cyan-900 
          px-6 py-4 rounded-xl text-lg font-bold text-white border border-black shadow-lg 
          transition duration-200 ease-in-out">
  <div class="w-9 h-12 sm:w-16 sm:h-20 bg-white rounded shadow-inner flex items-center justify-center overflow-hidden z-10">
    <img src="https://example.com/icon2.png" alt="Safety Icon" class="w-full h-full object-contain" />
  </div>
  <div class="absolute inset-0 flex items-center justify-center">
    <span class="menu-text text-2xl sm:text-3xl font-bold tracking-wide text-center" style="text-shadow: 1px 1px 2px black;">TSD</span>
</div>
</a>
  </div>
 
  </main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {
  getFirestore,
  collection,
  query,
  where,
  orderBy,
  limit,
  getDocs
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";
import {
  getStorage,
  ref,
  getDownloadURL
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-storage.js";

/* ðŸ”¹ Firebase init */
const firebaseConfig = {
  apiKey: "AIzaSyD4BfU5OKhKFynJMVC2k4qFEgmeDhLlSIM",
  authDomain: "doc4runningstaff-d000b.firebaseapp.com",
  projectId: "doc4runningstaff-d000b",
  storageBucket: "doc4runningstaff-d000b.firebasestorage.app",
  messagingSenderId: "34983733068",
  appId: "1:34983733068:web:bbe8a3d902eecaab8bd1e9"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

/* ðŸ”¹ COLOR MAP (Tailwind-safe) */
const colorMap = {
  red:   { bg: "bg-red-100",   border: "border-red-600",   text: "text-red-800",   btn: "bg-red-600 hover:bg-red-700" },
  yellow:{ bg: "bg-yellow-100",border: "border-yellow-600",text: "text-yellow-800",btn: "bg-yellow-600 hover:bg-yellow-700" },
  blue:  { bg: "bg-blue-100",  border: "border-blue-600",  text: "text-blue-800",  btn: "bg-blue-600 hover:bg-blue-700" },
  green: { bg: "bg-green-100", border: "border-green-600", text: "text-green-800", btn: "bg-green-600 hover:bg-green-700" },
  indigo:{ bg: "bg-indigo-100",border: "border-indigo-600",text: "text-indigo-800",btn: "bg-indigo-600 hover:bg-indigo-700" },
  gray:  { bg: "bg-gray-200",  border: "border-gray-500",  text: "text-gray-800",  btn: "bg-gray-600 hover:bg-gray-700" }
};

  const shedLobbies = [
  { code: "mao", name: "Madgaon" },
  { code: "rn",  name: "Ratnagiri" },
  { code: "ven", name: "Verna" },
  { code: "sl",  name: "Surathkal" }
];

async function loadLatestShedOrder() {
  const box = document.getElementById("latest-shed");

  // Skeleton
  box.innerHTML = `
    <div class="animate-pulse bg-gray-100 border border-gray-300 p-5 rounded-xl shadow"></div>
  `;

  try {
    const shedLobbies = [
      { code: "mao", name: "Madgaon Lobby",   bg: "bg-blue-50",   border: "border-blue-500" },
      { code: "rn",  name: "Ratnagiri Lobby", bg: "bg-green-50",  border: "border-green-500" },
      { code: "ven", name: "Verna Lobby",     bg: "bg-amber-50",  border: "border-amber-500" },
      { code: "sl",  name: "Surathkal Lobby", bg: "bg-indigo-50", border: "border-indigo-500" }
    ];

    const rows = [];

    for (const lobby of shedLobbies) {
      const q = query(
        collection(db, "documents"),
        where("category", "==", "shed_order"),
        where("lobby", "==", lobby.code)
      );

      const snap = await getDocs(q);

      const latest = snap.docs
        .map(d => d.data())
        .find(d => d.latestRank === 1);

      if (!latest) continue;

      const orderNo =
        latest.orderNo ||
        latest.title?.match(/\d{2}\/\d{4}/)?.[0] ||
        "";

      rows.push(`
        <div class="${lobby.bg} border-l-4 ${lobby.border}
                    rounded-lg p-4
                    flex justify-between gap-4">

          <!-- LEFT -->
          <div class="flex-1 min-w-0">
            <div class="text-[15px] font-bold text-gray-900 tracking-wide">
              ${orderNo}
            </div>

            <div class="text-[14px] text-gray-700 mt-1 leading-snug line-clamp-2">
              ${latest.description || ""}
            </div>
          </div>

          <!-- RIGHT -->
          <div class="flex flex-col items-end justify-between shrink-0">

            <div class="text-[12px] font-semibold
                        px-3 py-1 rounded-full
                        bg-white/80 text-gray-900
                        border ${lobby.border}">
              ${lobby.name}
            </div>

            <button
              onclick="openLatest('${latest.filePath}')"
              class="mt-3 bg-blue-700 hover:bg-blue-800
                     text-white px-4 py-2
                     rounded-md text-[13px] font-semibold
                     shadow active:scale-95 transition">
              View
            </button>

          </div>
        </div>
      `);
    } // âœ… FOR LOOP CLOSED HERE

    if (!rows.length) {
      box.innerHTML = "";
      return;
    }

    box.innerHTML = `
      <div class="bg-white border border-blue-300
                  rounded-xl shadow-md p-5
                  transition hover:shadow-lg">

        <h2 class="text-[18px] font-bold text-blue-900 mb-4 flex items-center gap-2">
          ðŸ“„ Shed Order
        </h2>

        <div class="space-y-3">
          ${rows.join("")}
        </div>
      </div>
    `;
  } catch (err) {
    console.error("Latest shed order error:", err);
    box.innerHTML = "";
  }
}
async function loadLatest({ category, containerId, title, color, icon }) {
  const box = document.getElementById(containerId);

  // Skeleton
  box.innerHTML = `
    <div class="animate-pulse bg-white p-5 rounded-xl shadow">
      <div class="h-5 bg-gray-200 w-1/2 mb-3 rounded"></div>
      <div class="h-4 bg-gray-200 w-3/4 mb-2 rounded"></div>
      <div class="h-4 bg-gray-200 w-2/3 rounded"></div>
    </div>
  `;

  try {
    const q = query(
      collection(db, "documents"),
      where("category", "==", category)
    );

    const snap = await getDocs(q);
    if (snap.empty) {
      box.innerHTML = "";
      return;
    }

    const docs = snap.docs
      .map(d => d.data())
      .filter(d => typeof d.latestRank === "number")
      .sort((a, b) => b.latestRank - a.latestRank);

    if (!docs.length) {
      box.innerHTML = "";
      return;
    }

    const data = docs[0];
    const c = colorMap[color];

    box.innerHTML = `
      <div class="bg-white border border-blue-300
            rounded-xl shadow-md p-5
            transition hover:shadow-lg">

  <h2 class="text-[19px] font-extrabold text-gray-800">
    ${icon} ${title}
  </h2>

  <div class="${c.bg} border-l-4 ${c.border}
              rounded-lg px-4 py-3
              flex flex-col min-h-[120px]">

    <div class="text-[15px] font-bold ${c.text}">
      ${data.circularNo || data.orderNo || "Latest Circular"}
    </div>

    <div class="text-[14px] text-gray-800 mt-1 leading-snug line-clamp-3">
      ${data.title || data.description || ""}
    </div>

    <div class="mt-auto flex justify-end pt-3">
      <button
        onclick="openLatest('${data.filePath}')"
        class="${c.btn}
               text-white px-4 py-1.5
               rounded-md text-[13px] font-semibold
               shadow hover:scale-105 transition">
        View
      </button>
    </div>

  </div>
</div>
    `;
  } catch (err) {
    console.error("Latest load error:", category, err);
    box.innerHTML = "";
  }
}
/* ðŸ”¹ Open PDF */
window.openLatest = async function (filePath) {
  const url = await getDownloadURL(ref(storage, filePath));
  window.open(url, "_blank");
};

/* ðŸ”¹ Load all latest cards */
window.addEventListener("DOMContentLoaded", () => {
  loadLatestShedOrder();

  loadLatest({
    category: "safety_circular",
    containerId: "latest-safety",
    title: "Safety Circular",
    color: "yellow",
    icon: "âš ï¸"
  });

  loadLatest({
    category: "counselling",
    containerId: "latest-counselling",
    title: "Counselling Topic",
    color: "blue",
    icon: "ðŸ§ "
  });

  loadLatest({
    category: "gsr",
    containerId: "latest-gsr",
    title: "G&SR Correction Slip",
    color: "green",
    icon: "ðŸ“˜"
  });

  loadLatest({
    category: "wtt",
    containerId: "latest-wtt",
    title: "WTT Correction Slip",
    color: "indigo",
    icon: "ðŸ•“"
  });

  loadLatest({
    category: "accident_manual",
    containerId: "latest-accident",
    title: "Accident Manual",
    color: "gray",
    icon: "ðŸš¨"
  });

  rotateSlogan();
});



window.addEventListener("DOMContentLoaded", () => {

  const menuBtn = document.getElementById("menu-button");
  const homeBtn = document.getElementById("home-button");
  const menuItems = document.getElementById("menu-items");
  const mainContent = document.getElementById("main-content");
  const banner = document.getElementById("latest-banner");

  menuBtn.addEventListener("click", () => {
    menuBtn.classList.add("hidden");
    homeBtn.classList.remove("hidden");

    mainContent.classList.add("hidden");
    banner.classList.add("hidden");

    menuItems.classList.remove("hidden");
  });

  homeBtn.addEventListener("click", () => {
    homeBtn.classList.add("hidden");
    menuBtn.classList.remove("hidden");

    menuItems.classList.add("hidden");

    mainContent.classList.remove("hidden");
    banner.classList.remove("hidden");
  });

});


  // âœ… Rotating slogans
  const slogans = [
    'Our Mission: Zero SPAD â€“ à¤¹à¤®à¤¾à¤°à¤¾ à¤²à¤•à¥à¤·à¥à¤¯: à¤¶à¥‚à¤¨à¥à¤¯ SPAD',
    'Safety First, Always!',
    'Alert Today â€“ Alive Tomorrow',
    'Better Late Than Never â€“ Drive Safe!'
  ];

  let currentSlogan = 0;
  const sloganEl = document.getElementById('slogan');

  function rotateSlogan() {
    sloganEl.textContent = slogans[currentSlogan];
    currentSlogan = (currentSlogan + 1) % slogans.length;
  }

  rotateSlogan();
  setInterval(rotateSlogan, 3000);

  


  document.querySelectorAll("a").forEach(link => {
    link.addEventListener("click", () => {
      const textSpan = link.querySelector(".menu-text");
      if (!textSpan) return;

      textSpan.classList.add("scale-110");

      setTimeout(() => {
        textSpan.classList.remove("scale-110");
      }, 300); // shorter duration for snappy feel
    });
  });

  // Clean up enlarged text if user comes back via browser back button
  window.addEventListener("pageshow", () => {
    document.querySelectorAll(".menu-text").forEach(span => {
      span.classList.remove("scale-110");
    });
  });



</script>

<footer
  class="fixed bottom-0 left-0 w-full z-40
         flex items-center justify-center
         text-xs sm:text-sm
         text-gray-700
         bg-white
         shadow-[0_-2px_8px_rgba(0,0,0,0.08)]
         h-[var(--footer-height)]">
  Â© <span class="footer-year ml-1"></span>&nbsp;Combined Crew Lobby Â· Madgaon. All Rights Reserved
</footer>

<script>
  document.querySelectorAll(".footer-year").forEach(el => {
    el.textContent = new Date().getFullYear();
  });
</script>
  
  </body>
    </html>
